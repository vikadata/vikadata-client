(()=>{var e={14:(e,o,t)=>{const{webContents:l,ipcMain:n,dialog:a}=t(933),{autoUpdater:r}=t(346),{publishUrl:s,env:c}=t(177);let d="";function p(e,o){l.getFocusedWebContents().send("message",{message:e,data:o})}e.exports={checkForUpdate:()=>{r.setFeedURL("development"===c.prod?s.prod:s.dev),r.on("error",(e=>{p("err",e)})),r.on("update-not-available",((e,o)=>{a.showMessageBox({message:"未检测到新版本"})})),r.on("checking-for-update",(e=>{console.log("darker",e),p("checking-for-update",e)})),r.on("download-progress",(e=>{p("download-progress",e)})),r.on("update-downloaded",((e,o,t,l,n,s)=>{a.showMessageBox({message:`检测到新版本${d.version}，是否立即升级？`}),r.quitAndInstall(),p("isUpdateNow",d)})),r.checkForUpdates().then((e=>{d=e.updateInfo}))}}},177:e=>{e.exports={env:{prod:"production",dev:"development",local:"localhost"},publishUrl:{prod:"https://vika-client-download.s3.cn-northwest-1.amazonaws.com.cn/prod/",dev:"https://vika-client-download.s3.cn-northwest-1.amazonaws.com.cn/integration/"}}},747:(e,o,t)=>{const{app:l,shell:n,webContents:a,Menu:r}=t(933),{env:s}=t(177),{getUrl:c}=t(288),{checkForUpdate:d}=t(14);let p="development";function i(e){p=e;const o=`${a.userAgent} VikaDesktop/${process.env["npm_package_version:"]}`;a.getFocusedWebContents().loadURL(c(p),{userAgent:o})}const u=[{label:l.name,submenu:[{role:"about",label:"关于维格表"},{label:"检查更新",click:()=>d()},{type:"separator"},{role:"quit",label:"退出维格表"}]},{label:"文件",submenu:[{role:"close",label:"关闭当前窗口"}]},{label:"编辑",submenu:[{role:"undo",label:"撤消"},{role:"redo",label:"重做"},{role:"cut",label:"剪切"},{role:"copy",label:"复制"},{role:"paste",label:"粘贴"},{role:"selectAll",label:"全选"}]},{label:"工具",submenu:[{role:"reload",label:"刷新"},{role:"toggleDevTools",label:"开发者工具"},{role:"togglefullscreen",label:"全屏展示"},{label:"切换环境",submenu:[{label:"localhost",type:"radio",checked:p===s.local,click:()=>i(s.local)},{label:"integration",type:"radio",checked:p===s.dev,click:()=>i(s.dev)},{label:"staging",type:"radio",checked:p===s.prod,click:()=>i(s.prod)}],visible:p===s.dev||p===s.local}]},{label:"帮助",submenu:[{label:"帮助文档",click:()=>{n.openExternal("https://vika.cn/help")}}]}],b=r.buildFromTemplate(u);r.setApplicationMenu(b),e.exports={currentEnv:p}},288:(e,o,t)=>{const{env:l}=t(177);e.exports.getUrl=e=>{switch(e){case l.prod:return"https://vika.cn/";case l.dev:return"https://integration.vika.ltd/";default:return"http://localhost:3000/"}}},933:e=>{"use strict";e.exports=require("electron")},346:e=>{"use strict";e.exports=require("electron-updater")}},o={};function t(l){if(o[l])return o[l].exports;var n=o[l]={exports:{}};return e[l](n,n.exports,t),n.exports}(()=>{const{app:e,shell:o,BrowserWindow:l,Menu:n}=t(933),{currentEnv:a}=t(747),{getUrl:r}=t(288),{checkForUpdate:s}=t(14);let c=null;function d(){c=new l({width:1200,height:800,minWidth:320,minHeight:568,webPreferences:{nodeIntegration:!0},enableRemoteModule:!1});const e=`${c.webContents.userAgent} VikaDesktop/${process.env.npm_package_version}`;c.loadURL(r(a),{userAgent:e}),c.webContents.once("dom-ready",(()=>{s()}))}e.on("ready",d),e.setAppUserModelId("维格表"),e.on("window-all-closed",(()=>{"darwin"!==process.platform&&e.quit()})),e.on("activate",(()=>{0===l.getAllWindows().length&&d()})),e.on("web-contents-created",((e,t)=>{t.on("new-window",((e,t)=>{e.preventDefault(),o.openExternal(t)}))}))})()})();